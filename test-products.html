<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Test Products API</title>
    <style>
        img { max-width: 100px; margin-right: 5px; }
        li { margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>Lista de Produtos</h1>
    <button onclick="loadProducts()">Carregar Produtos</button>
    <ul id="productList"></ul>

    <h2>Buscar Produto por ID</h2>
    <input type="number" id="productId" placeholder="ID do Produto">
    <button onclick="loadProductById()">Buscar</button>
    <pre id="productDetail"></pre>

    <script>
        const baseURL = "http://localhost/Dona-Angela-Store-/api/Products";

        async function loadProducts() {
            try {
                const res = await fetch(baseURL + "/", { method: "GET" });
                const data = await res.json();

                const ul = document.getElementById("productList");
                ul.innerHTML = "";

                data.products.forEach(p => {
                    const li = document.createElement("li");
                    li.innerHTML = `
                        <strong>${p.name}</strong> - R$ ${p.price} <br/>
                        Marca: ${p.brand} | Categoria: ${p.category} <br/>
                        Fotos: ${p.photos && p.photos.length ? p.photos.map(photo => `<img src="${photo}" />`).join("") : "Nenhuma"}
                    `;
                    ul.appendChild(li);
                });
            } catch (err) {
                alert("Erro ao carregar produtos: " + err.message);
            }
        }

        async function loadProductById() {
            const id = document.getElementById("productId").value;
            if (!id) return alert("Digite um ID válido");

            try {
                const res = await fetch(`${baseURL}/id/${id}`, { method: "GET" });
                const data = await res.json();

                if (data.product) {
                    const p = data.product;
                    document.getElementById("productDetail").innerHTML = `
                        <strong>${p.name}</strong> - R$ ${p.price} <br/>
                        Marca: ${p.brand} | Categoria: ${p.category} <br/>
                        Fotos: ${p.photos && p.photos.length ? p.photos.map(photo => `<img src="${photo}" />`).join("") : "Nenhuma"} <br/>
                        Descrição: ${p.description}
                    `;
                } else {
                    document.getElementById("productDetail").textContent = "Produto não encontrado";
                }
            } catch (err) {
                alert("Erro ao buscar produto: " + err.message);
            }
        }
    </script>
</body>
</html>